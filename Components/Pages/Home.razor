@page "/home"
@inject  UserService Userservice

<NavMenu></NavMenu>
<MudLayout>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Large">
            <!-- Dashboard Header -->
            <MudGrid Container Spacing="4">
                <MudItem xs="12" sm="6" md="4">
                    <MudCard Class="pa-4" Style="background-color: #e0f7fa;">
                        <MudText Typo="Typo.h6" Align="Align.Center">Total Inflow</MudText>
                        <MudText Typo="Typo.h4" Align="Align.Center" Color="Color.Primary">
                            $@totalInflow
                        </MudText>
                    </MudCard>
                </MudItem>

                <MudItem xs="12" sm="6" md="4">
                    <MudCard Class="pa-4" Style="background-color: #ffebee;">
                        <MudText Typo="Typo.h6" Align="Align.Center">Total Outflow</MudText>
                        <MudText Typo="Typo.h4" Align="Align.Center" Color="Color.Error">
                            $@totalOutflow
                        </MudText>
                    </MudCard>
                </MudItem>

                <MudItem xs="12" sm="6" md="4">
                    <MudCard Class="pa-4" Style="background-color: #c8e6c9;">
                        <MudText Typo="Typo.h6" Align="Align.Center">Current Balance</MudText>
                        <MudText Typo="Typo.h4" Align="Align.Center" Color="Color.Success">
                            $@currentBalance
                        </MudText>
                    </MudCard>
                </MudItem>
            </MudGrid>

            <!-- Financial Overview Charts -->
            <MudGrid Container Spacing="4">
                <!-- Bar Chart -->
                <MudItem xs="12" sm="6">
                    <MudCard Class="pa-4">
                        <MudText Typo="Typo.h6" Align="Align.Center">Monthly Inflow & Outflow</MudText>
                        <MudChart ChartType="ChartType.Bar" ChartSeries="@series" XAxisLabels="@XAxisLabels" Width="100%" Height="300px"></MudChart>
                    </MudCard>
                </MudItem>

                <!-- Pie Chart -->
                <MudItem xs="12" sm="6">
                    <MudCard Class="pa-4">
                        <MudText Typo="Typo.h6" Align="Align.Center">Expense Breakdown</MudText>
                        <MudChart ChartType="ChartType.Pie" InputData="@expenseData" InputLabels="@expenseLabels" Width="100%" Height="300px"></MudChart>
                    </MudCard>
                </MudItem>
            </MudGrid>
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private double totalInflow = 0;
    private double totalOutflow = 0;
    private double currentBalance = 0;

    private List<ChartSeries> series = new List<ChartSeries>
    {
        new ChartSeries() { Name = "Inflow", Data = new double[] { 50, 60, 70, 80, 90, 100 } },
        new ChartSeries() { Name = "Outflow", Data = new double[] { 40, 50, 60, 65, 70, 80 } }
    };

    private string[] XAxisLabels = { "Jan", "Feb", "Mar", "Apr", "May", "Jun" };

    private double[] expenseData = { 50, 25, 20, 5 };
    private string[] expenseLabels = { "Food", "Transport", "Entertainment", "Other" };

    protected override async Task OnInitializedAsync()
    {
        // Fetch and calculate the total inflow, outflow, and current balance
        totalInflow =  Userservice.GetTotalInflow();
        totalOutflow =  Userservice.GetTotalOutflow();
        currentBalance = Userservice.GetRemaingBalance();
    }
}
